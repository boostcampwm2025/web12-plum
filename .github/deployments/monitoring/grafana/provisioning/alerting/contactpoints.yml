# Grafana Contact Points - ì•Œë¦¼ ì±„ë„ ì„¤ì •
# Slackê³¼ Emailë¡œ ì•Œë¦¼ ì „ì†¡
# í™˜ê²½ë³€ìˆ˜: SLACK_WEBHOOK_URL, ALERT_EMAIL_ADDRESSES

apiVersion: 1

contactPoints:
  # Email ì•Œë¦¼ ì„¤ì •
  - orgId: 1  # Grafana ì¡°ì§ ID (ê¸°ë³¸ê°’: 1)
    name: email
    receivers:
      - uid: email-receiver
        type: email
        settings:
          # ì•Œë¦¼ì„ ë°›ì„ ì´ë©”ì¼ ì£¼ì†Œ 
          addresses: ${ALERT_EMAIL_ADDRESSES}
          subject: "[{{ .Status | toUpper }}] {{ .CommonLabels.alertname }}"
        disableResolveMessage: false

  # Slack ì•Œë¦¼ ì„¤ì •
  - orgId: 1
    name: slack
    receivers:
      - uid: slack-receiver
        type: slack
        settings:
          # Slack Webhook URL
          url: ${SLACK_WEBHOOK_URL}
          title: "{{ .CommonLabels.alertname }}"
          text: |
            {{ range .Alerts }}
            **Status:** {{ .Status }}
            **Summary:** {{ .Annotations.summary }}
            **Description:** {{ .Annotations.description }}
            {{ end }}
        disableResolveMessage: false

  # Slack + Email ë™ì‹œ ì „ì†¡ (ì¤‘ìš” ì•Œë¦¼ìš©)
  - orgId: 1
    name: all-channels
    receivers:
      - uid: email-all
        type: email
        settings:
          addresses: ${ALERT_EMAIL_ADDRESSES}
          subject: "[{{ .Status | toUpper }}] {{ .CommonLabels.alertname }}"
      - uid: slack-all
        type: slack
        settings:
          url: ${SLACK_WEBHOOK_URL}
          title: "ğŸš¨ {{ .CommonLabels.alertname }}"
          text: |
            **í™˜ê²½:** {{ .CommonLabels.environment }}
            **ì‹¬ê°ë„:** {{ .CommonLabels.severity }}
            **ìš”ì•½:** {{ .Annotations.summary }}
            **ìƒì„¸:** {{ .Annotations.description }}
